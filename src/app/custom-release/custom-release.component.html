<div class="whiteContainer">
  <div class="row">
    <div class="col-12">
      <app-title
        [title]="'Custom Release'"
        [bigTitle]="true"></app-title>
    </div>
    <div class="col-12 mt-5">
      <div class="formTable">
        <form class="mt-2" name="form" class="example-form" method="post"
              [formGroup]="regCustomReleaseForm"
              (keydown.enter)="$event.preventDefault()"
              (ngSubmit)="onSubmit()" novalidate xmlns="http://www.w3.org/1999/html"
              autocomplete="off">
          <tabset class="tabs" type="pills" #formTabs>
            <tab heading="Policy Details">
              <div class="mt-5">
                <div class="row">
                  <div class="col-12">
                    <app-title [smallTitle]="true" [title]="'Policy Details'"></app-title>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>BOL</mat-label>
                      <input type="text" class="form-control" matInput formControlName="bol"
                             placeholder="BOL" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('bol').invalid && (regCustomReleaseForm.get('bol').dirty || regCustomReleaseForm.get('bol').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('bol').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('bol').errors.pattern">
                          this field must start with <b>Character</b> or <b>Number</b>
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <section class="example-section mt-4">
                      <mat-checkbox class="example-margin"
                                    formControlName="withinIncluded">
                        Within included
                      </mat-checkbox>
                    </section>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Requested Release Type</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Requested Release Type"
                             aria-label="Requested Release Type"
                             matInput
                             formControlName="requestedReleaseType"
                             [matAutocomplete]="requestedReleaseTypeList" required>
                      <mat-autocomplete #requestedReleaseTypeList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForRequestedReleaseType | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('requestedReleaseType').invalid && (regCustomReleaseForm.get('requestedReleaseType').dirty || regCustomReleaseForm.get('requestedReleaseType').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('requestedReleaseType').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field appearance="fill">
                      <mat-label>Applicant</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Applicant"
                             aria-label="Applicant"
                             matInput
                             formControlName="applicant"
                             [readonly]="true">
                      <div
                        *ngIf="regCustomReleaseForm.get('applicant').invalid && (regCustomReleaseForm.get('applicant').dirty || regCustomReleaseForm.get('applicant').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('applicant').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Custom Port name</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Custom Port name"
                             aria-label="Custom Port name"
                             matInput
                             formControlName="customPortName"
                             [matAutocomplete]="customPortNameList" required>
                      <mat-autocomplete #customPortNameList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForCustomPortName | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('customPortName').invalid && (regCustomReleaseForm.get('customPortName').dirty || regCustomReleaseForm.get('customPortName').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('customPortName').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>POD</mat-label>
                      <input type="text" class="form-control" matInput formControlName="pod"
                             placeholder="POD">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Supplier Name</mat-label>
                      <input type="text" class="form-control" matInput formControlName="supplierName"
                             placeholder="Supplier Name ">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Supplier County</mat-label>
                      <input type="text" class="form-control" matInput formControlName="supplierCounty"
                             placeholder="Supplier County">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Carrier name</mat-label>
                      <input type="text" class="form-control" matInput formControlName="carrierName"
                             placeholder="Carrier name">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <div class="row">
                      <div class="col-12 col-sm-9">
                        <div class="form-group">
                          <label>
                            Gross weight
                            <span class="requiredStar">*</span>
                          </label>
                          <mat-slider
                            class="example-margin mt-3"
                            [max]="500"
                            [min]="0"
                            [step]="1"
                            required
                            formControlName="grossWeight">
                          </mat-slider>
                        </div>
                      </div>
                      <div class="col-12 col-sm-3">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <input type="text" class="form-control" matInput
                                 [value]="regCustomReleaseForm.get('grossWeight').value"
                                 formControlName="grossWeight"
                                 (change)="setShelfValue($event)" required>
                          <span class="labelForRange">KG</span>
                          <div
                            *ngIf="regCustomReleaseForm.get('grossWeight').invalid"
                            class="alert alert-danger">
                            <div
                              *ngIf="regCustomReleaseForm.get('grossWeight').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Measure Unit</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Measure Unit"
                             aria-label="Measure Unit"
                             matInput
                             formControlName="measureUnit"
                             [matAutocomplete]="measureUnitList" required>
                      <mat-autocomplete #measureUnitList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForMeasureUnitList | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('measureUnit').invalid && (regCustomReleaseForm.get('measureUnit').dirty || regCustomReleaseForm.get('measureUnit').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('measureUnit').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Receipt Number</mat-label>
                      <input type="text" class="form-control" matInput formControlName="receiptNumber"
                             placeholder="Receipt Number" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('receiptNumber').invalid && (regCustomReleaseForm.get('receiptNumber').dirty || regCustomReleaseForm.get('receiptNumber').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptNumber').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptNumber').errors.pattern">
                          this field must not start with number
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Group Number</mat-label>
                      <input type="text" class="form-control" matInput formControlName="groupNumber"
                             placeholder="Group Number" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('groupNumber').invalid && (regCustomReleaseForm.get('groupNumber').dirty || regCustomReleaseForm.get('groupNumber').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('groupNumber').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Receipt Value</mat-label>
                      <input type="text" class="form-control" matInput
                             pattern="^(\d{1,3}(,\d{3})|\d)*(\.\d+)?$"
                             (change)="getDecimalValue(regCustomReleaseForm.get('receiptValue').value, '')"
                             formControlName="receiptValue"
                             placeholder="Receipt Value" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('receiptValue').invalid && (regCustomReleaseForm.get('receiptValue').dirty || regCustomReleaseForm.get('receiptValue').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptValue').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptValue').errors.pattern">
                          this field must be <strong>Decimal number</strong> as 00.0
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </tab>
            <tab heading="Invoice Data"></tab>
            <tab heading="Attachments" class="Attachments"></tab>
          </tabset>
          <div class="row buttonContainer btm-out">
            <div class="col-12 d-flex flex-column flex-md-row mt-3">
              <button *ngIf="!formTabs.tabs[0].active"
                      type="button"
                      class="btn btn-primary btn-sm mr-3 bottomButtons "
                      (click)="backToNextTab()">
                Back
              </button>
              <div class="ml-md-auto ">
                <button *ngIf="!formTabs.tabs[2].active"
                        type="button"
                        class="btn btn-primary btn-sm mr-3 bottomButtons"
                        (click)="nextToNextTab()">
                  Next Forward
                </button>

                <button type="button"
                        class="btn btn-primary btn-sm mr-3 bottomButtons"
                        [disabled]="false"
                        (click)="saveData()">
                  Save
                </button>
                <button
                  type="submit"
                  class="btn btn-primary btn-sm">
                  Submit
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<alert type="success" (onClosed)="onClosed()" *ngIf="alertNotificationStatus">
  <strong>Thank You</strong> <br> {{alertNotification.msg}}
</alert>

<alert type="danger" class="AlertForAllRequests" dismissible="true" (onClosed)="onClosedErrorAlert()"
       *ngIf="alertErrorNotificationStatus">
  <strong>Error message</strong> <br> {{alertErrorNotification.msg}}
</alert>

<ng-template #successSubmissionModal>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Successful Submission</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closeSuccessSubmissionModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="modalContainer">
      <h2>
        <span>
          <i class="fas fa-check-circle"></i>
        </span>
      </h2>
      <h3>
        Thank you for submission
      </h3>
      <h3>
        Your request {{dataInAnyError.NotificationNo ? 'Notification Number' : 'id'}} is
        <b>{{ dataInAnyError.NotificationNo ? dataInAnyError.NotificationNo : dataInAnyError.id}}</b>
      </h3>
    </div>
  </div>
</ng-template>

<app-loader-component [loadingStatus]="isLoading"></app-loader-component>
