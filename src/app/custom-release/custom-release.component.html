<div class="whiteContainer">
  <div class="row">
    <div class="col-12">
      <app-title
        [title]="'Custom Release'"
        [bigTitle]="true"></app-title>
    </div>
    <div class="col-12 mt-5 formTableContainer">
      <div class="formTable">
        <form class="mt-2" name="form" class="example-form" method="post"
              [formGroup]="regCustomReleaseForm"
              (keydown.enter)="$event.preventDefault()"
              (ngSubmit)="onSubmit()" novalidate xmlns="http://www.w3.org/1999/html"
              autocomplete="off">
          <tabset class="tabs" type="pills" #formTabs>
            <tab heading="Bill of landing">
              <div class="mt-5">
                <div class="row">
                  <div class="col-12">
                    <app-title [smallTitle]="true" [title]="'Bol Details'"></app-title>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>BOL</mat-label>
                      <input type="text" class="form-control" matInput formControlName="bol"
                             placeholder="BOL" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('bol').invalid && (regCustomReleaseForm.get('bol').dirty || regCustomReleaseForm.get('bol').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('bol').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('bol').errors.pattern">
                          this field must start with <b>Character</b> or <b>Number</b>
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <section class="example-section mt-4">
                      <mat-checkbox class="example-margin"
                                    formControlName="withinIncluded">
                        Within included
                      </mat-checkbox>
                    </section>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Requested Release Type</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Requested Release Type"
                             aria-label="Requested Release Type"
                             matInput
                             formControlName="requestedReleaseType"
                             [matAutocomplete]="requestedReleaseTypeList" required>
                      <mat-autocomplete #requestedReleaseTypeList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForRequestedReleaseType | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('requestedReleaseType').invalid && (regCustomReleaseForm.get('requestedReleaseType').dirty || regCustomReleaseForm.get('requestedReleaseType').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('requestedReleaseType').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field appearance="fill">
                      <mat-label>Applicant</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Applicant"
                             aria-label="Applicant"
                             matInput
                             formControlName="applicant"
                             [readonly]="true">
                      <div
                        *ngIf="regCustomReleaseForm.get('applicant').invalid && (regCustomReleaseForm.get('applicant').dirty || regCustomReleaseForm.get('applicant').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('applicant').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Custom Port name</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Custom Port name"
                             aria-label="Custom Port name"
                             matInput
                             formControlName="customPortName"
                             [matAutocomplete]="customPortNameList" required>
                      <mat-autocomplete #customPortNameList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForCustomPortName | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('customPortName').invalid && (regCustomReleaseForm.get('customPortName').dirty || regCustomReleaseForm.get('customPortName').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('customPortName').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>POD</mat-label>
                      <input type="text" class="form-control" matInput formControlName="pod"
                             placeholder="POD">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Supplier Name</mat-label>
                      <input type="text" class="form-control" matInput formControlName="supplierName"
                             placeholder="Supplier Name ">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Supplier County</mat-label>
                      <input type="text" class="form-control" matInput formControlName="supplierCounty"
                             placeholder="Supplier County">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Carrier name</mat-label>
                      <input type="text" class="form-control" matInput formControlName="carrierName"
                             placeholder="Carrier name">
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <div class="row">
                      <div class="col-12 col-sm-9">
                        <div class="form-group">
                          <label>
                            Gross weight
                            <span class="requiredStar">*</span>
                          </label>
                          <mat-slider
                            class="example-margin mt-3"
                            [max]="500"
                            [min]="0"
                            [step]="1"
                            required
                            formControlName="grossWeight">
                          </mat-slider>
                        </div>
                      </div>
                      <div class="col-12 col-sm-3">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <input type="text" class="form-control" matInput
                                 [value]="regCustomReleaseForm.get('grossWeight').value"
                                 formControlName="grossWeight"
                                 (change)="setShelfValue($event)" required>
                          <span class="labelForRange">KG</span>
                          <div
                            *ngIf="regCustomReleaseForm.get('grossWeight').invalid"
                            class="alert alert-danger">
                            <div
                              *ngIf="regCustomReleaseForm.get('grossWeight').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Measure Unit</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Measure Unit"
                             aria-label="Measure Unit"
                             matInput
                             formControlName="measureUnit"
                             [matAutocomplete]="measureUnitList" required>
                      <mat-autocomplete #measureUnitList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForMeasureUnitList | async"
                                    [value]="option.NAME">
                          <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regCustomReleaseForm.get('measureUnit').invalid && (regCustomReleaseForm.get('measureUnit').dirty || regCustomReleaseForm.get('measureUnit').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('measureUnit').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Receipt Number</mat-label>
                      <input type="text" class="form-control" matInput formControlName="receiptNumber"
                             placeholder="Receipt Number" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('receiptNumber').invalid && (regCustomReleaseForm.get('receiptNumber').dirty || regCustomReleaseForm.get('receiptNumber').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptNumber').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptNumber').errors.pattern">
                          this field must not start with number
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Group Number</mat-label>
                      <input type="text" class="form-control" matInput formControlName="groupNumber"
                             placeholder="Group Number" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('groupNumber').invalid && (regCustomReleaseForm.get('groupNumber').dirty || regCustomReleaseForm.get('groupNumber').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('groupNumber').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Receipt Value</mat-label>
                      <input type="text" class="form-control" matInput
                             pattern="^(\d{1,3}(,\d{3})|\d)*(\.\d+)?$"
                             (change)="getDecimalValue(regCustomReleaseForm.get('receiptValue').value, '')"
                             formControlName="receiptValue"
                             placeholder="Receipt Value" required>
                      <div
                        *ngIf="regCustomReleaseForm.get('receiptValue').invalid && (regCustomReleaseForm.get('receiptValue').dirty || regCustomReleaseForm.get('receiptValue').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptValue').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regCustomReleaseForm.get('receiptValue').errors.pattern">
                          this field must be <strong>Decimal number</strong> as 00.0
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width mainRequest">
                      <mat-label>Estimated Value</mat-label>
                      <input type="text" class="form-control" matInput formControlName="estimatedValue"
                             placeholder="Estimated Value"
                             [readonly]="true">
                    </mat-form-field>
                  </div>
                  <div class="col-12 mt-5 borderTop pt-5">
                    <div class="d-flex flex-column">
                      <div class="row">
                        <div class="col-12 col-sm-8">
                          <app-title [smallTitle]="true" [title]="'Invoice Details'"></app-title>
                        </div>
                        <div class="col-12 col-sm-4 ml-auto">
                          <div class="d-flex align-items-center">
                            <div class="hintForEmptyObject"
                                 *ngIf="invoiceListTable?.tableBody.length === 0 && attachmentRequiredStatus">
                              <h5>** Please add invoices data</h5>
                            </div>
                            <button type="button" class="btn btn-primary btnForModal ml-auto"
                                    (click)="showInvoiceContainer()">
                              Add new invoice
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <app-table-list [data]="invoiceListTable"
                                    [whichTable]="'invoiceList'">
                    </app-table-list>
                  </div>
                </div>
              </div>
            </tab>
            <tab heading="Attachments" class="Attachments">
              <div class="mt-5">
                <app-title [smallTitle]="true" [title]="'Attachement'"></app-title>
                <div class="row mt-3">
                  <div class="col-lg-4 col-sm-6 col-12" *ngFor="let field of attachmentFields">
                    <div class="form-group" *ngIf="field.enable">
                      <label>
                        {{field.name}}
                        <span class="requiredStar" *ngIf="field.required">*</span>
                      </label>
                      <div class="custom-file fileUpload mr-3" id="customFile"
                           [ngClass]="{'required': (regCustomReleaseForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'}">
                        <input type="file" class="custom-file-input" [id]="field.id"
                               aria-describedby="fileHelp"
                               (change)="onFileSelect($event, field.id)"
                               [required]="field.required ? 'required' : false">
                        <div class="d-flex alert alert-danger"
                             *ngIf="(regCustomReleaseForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'">
                          <div class="ml-auto mr-2" *ngIf="field.attachmentTypeStatus === 'No'">
                            this file must be as PDF and less than 5MB.
                          </div>
                          <div class="ml-auto"
                               *ngIf="regCustomReleaseForm.get(field.id).invalid && attachmentRequiredStatus">
                            <div *ngIf="regCustomReleaseForm.get(field.id).errors.required">
                              this field is required.
                            </div>
                          </div>
                        </div>
                        <label class="custom-file-label" [for]="field.id">
                          {{field.fileName ? field.fileName : 'Choose file'}}
                        </label>
                        <button type="button" class="custom-file-download-Button" *ngIf="field.fileValue"
                                (click)="downloadFile(field.id)">Download
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </tab>
          </tabset>
          <div class="row buttonContainer btm-out">
            <div class="col-12 d-flex flex-column flex-md-row mt-3">
              <button *ngIf="!formTabs.tabs[0].active"
                      type="button"
                      class="btn btn-primary btn-sm mr-3 bottomButtons "
                      (click)="backToNextTab(formTabs)">
                Back
              </button>
              <div class="ml-md-auto ">
                <button *ngIf="!formTabs.tabs[1].active"
                        type="button"
                        class="btn btn-primary btn-sm mr-3 bottomButtons"
                        (click)="nextToNextTab(formTabs)">
                  Next Forward
                </button>

                <button type="button"
                        class="btn btn-primary btn-sm mr-3 bottomButtons"
                        [disabled]="false"
                        (click)="saveData()">
                  Save
                </button>
                <button
                  type="submit"
                  class="btn btn-primary btn-sm">
                  Submit
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="invoiceFormContainer" *ngIf="invoiceContainerDisplayStatus">
        <div class="col-12 mb-3">
          <div class="d-flex flex-column">
            <div class="row">
              <div class="col-12 col-sm-8">
                <app-title [smallTitle]="true" [title]="'Invoice Details'"></app-title>
              </div>
              <div class="col-12 col-sm-4 ml-auto">
                <div class="d-flex align-items-center">
                  <button type="button" class="close ml-auto"
                          (click)="hideInvoiceContainer()">
                    X
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <form class="mt-2" name="invoiceForm" class="example-form" method="post"
              [formGroup]="regInvoicesForm"
              (keydown.enter)="$event.preventDefault()"
              (ngSubmit)="onSubmitInvoices()" novalidate xmlns="http://www.w3.org/1999/html"
              autocomplete="off">
          <tabset class="tabs" type="pills" #invoicesTabs>
            <tab heading="Invoice Details">
              <div class="mt-5">
                <div class="row mt-3">
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width">
                      <mat-label>Invoice No.</mat-label>
                      <input type="text" class="form-control" matInput formControlName="invoiceNo"
                             placeholder="Invoice No." required>
                      <div
                        *ngIf="regInvoicesForm.get('invoiceNo').invalid && (regInvoicesForm.get('invoiceNo').dirty || regInvoicesForm.get('invoiceNo').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regInvoicesForm.get('invoiceNo').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <section class="example-section mt-4">
                      <mat-checkbox class="example-margin"
                                    formControlName="withinIncluded">
                        Within included
                      </mat-checkbox>
                    </section>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Invoice Value</mat-label>
                      <input type="text" class="form-control" matInput
                             pattern="^(\d{1,3}(,\d{3})|\d)*(\.\d+)?$"
                             (change)="getDecimalValue(regInvoicesForm.get('invoiceValue').value, '')"
                             formControlName="invoiceValue"
                             placeholder="Invoice Value" required>
                      <div
                        *ngIf="regInvoicesForm.get('invoiceValue').invalid && (regInvoicesForm.get('invoiceValue').dirty || regInvoicesForm.get('invoiceValue').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regInvoicesForm.get('invoiceValue').errors.required">
                          this field is required
                        </div>
                        <div
                          *ngIf="regInvoicesForm.get('invoiceValue').errors.pattern">
                          this field must be <strong>Decimal number</strong> as 00.0
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field appearance="fill">
                      <mat-label>Invoice date</mat-label>
                      <input matInput [matDatepicker]="picker" formControlName="invoiceDate" required>
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                      <div
                        *ngIf="regInvoicesForm.get('invoiceDate').invalid && (regInvoicesForm.get('invoiceDate').dirty || regInvoicesForm.get('invoiceDate').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regInvoicesForm.get('invoiceDate').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Country of origin</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Country of origin"
                             aria-label="Country of origin"
                             matInput
                             formControlName="countryOfOrigin"
                             [matAutocomplete]="countryOfOriginList" required>
                      <mat-autocomplete #countryOfOriginList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForCountryOfOrigin | async"
                                    [value]="option.NAME">
                                      <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                            placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regInvoicesForm.get('countryOfOrigin').invalid && (regInvoicesForm.get('countryOfOrigin').dirty || regInvoicesForm.get('countryOfOrigin').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regInvoicesForm.get('countryOfOrigin').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-lg-4 col-sm-6 col-12">
                    <mat-form-field class="example-full-width inputBesideSelect">
                      <mat-label>Currency</mat-label>
                      <input type="text"
                             class="form-control"
                             placeholder="Currency"
                             aria-label="Currency"
                             matInput
                             formControlName="currency"
                             [matAutocomplete]="CurrencyList" required>
                      <mat-autocomplete #CurrencyList="matAutocomplete">
                        <mat-option *ngFor="let option of filteredOptionsForCurrency | async"
                                    [value]="option.NAME">
                                      <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                            placement="top">{{option.NAME}}</span>
                        </mat-option>
                      </mat-autocomplete>
                      <div
                        *ngIf="regInvoicesForm.get('currency').invalid && (regInvoicesForm.get('currency').dirty || regInvoicesForm.get('currency').touched)"
                        class="alert alert-danger">
                        <div
                          *ngIf="regInvoicesForm.get('currency').errors.required">
                          this field is required
                        </div>
                      </div>
                    </mat-form-field>
                  </div>
                  <div class="col-12 mt-5 borderTop pt-5">
                    <div class="d-flex flex-column">
                      <div class="row">
                        <div class="col-12 col-sm-8">
                          <app-title [smallTitle]="true" [title]="'Items Details'"></app-title>
                        </div>
                        <div class="col-12 col-sm-4 ml-auto">
                          <div class="d-flex align-items-center">
                            <div class="hintForEmptyObject"
                                 *ngIf="itemListTable?.tableBody.length === 0 && attachmentRequiredStatus">
                              <h5>** Please add item data</h5>
                            </div>
                            <button type="button" class="btn btn-primary btnForModal ml-auto"
                                    (click)="showItemContainer()">
                              Add new item
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <app-table-list [data]="itemListTable"
                                    [whichTable]="'invoiceList'">
                    </app-table-list>
                  </div>
                </div>
              </div>
            </tab>
            <tab heading="Attachments" class="Attachments">
              <div class="mt-5">
                <div class="row mt-3">
                  <div class="col-lg-4 col-sm-6 col-12" *ngFor="let field of InvoiceAttachmentFields">
                    <div class="form-group" *ngIf="field.enable">
                      <label>
                        {{field.name}}
                        <span class="requiredStar" *ngIf="field.required">*</span>
                      </label>
                      <div class="custom-file fileUpload mr-3"
                           [ngClass]="{'required': (regInvoicesForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'}">
                        <input type="file" class="custom-file-input" [id]="field.id"
                               aria-describedby="fileHelp"
                               (change)="onFileSelect($event, field.id)"
                               [required]="field.required ? 'required' : false">
                        <div class="d-flex alert alert-danger"
                             *ngIf="(regInvoicesForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'">
                          <div class="ml-auto mr-2" *ngIf="field.attachmentTypeStatus === 'No'">
                            this file must be as PDF and less than 5MB.
                          </div>
                          <div class="ml-auto"
                               *ngIf="regInvoicesForm.get(field.id).invalid && attachmentRequiredStatus">
                            <div *ngIf="regInvoicesForm.get(field.id).errors.required">
                              this field is required.
                            </div>
                          </div>
                        </div>
                        <label class="custom-file-label" [for]="field.id">
                          {{field.fileName ? field.fileName : 'Choose file'}}
                        </label>
                        <button type="button" class="custom-file-download-Button" *ngIf="field.fileValue"
                                (click)="downloadFile(field.id)">Download
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </tab>
          </tabset>
          <div class="row buttonContainer btm-out">
            <div class="col-12 d-flex flex-column flex-md-row mt-3">
              <button *ngIf="!invoicesTabs.tabs[0].active"
                      type="button"
                      class="btn btn-primary btn-sm mr-3 bottomButtons "
                      (click)="backToNextTab(invoicesTabs)">
                Back
              </button>
              <div class="ml-md-auto ">
                <button *ngIf="!invoicesTabs.tabs[1].active"
                        type="button"
                        class="btn btn-primary btn-sm mr-3 bottomButtons"
                        (click)="nextToNextTab(invoicesTabs)">
                  Next Forward
                </button>
                <button
                  type="submit"
                  class="btn btn-primary btn-sm">
                  add Invoice
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="itemsFormContainer" *ngIf="itemContainerDisplayStatus">
        <div class="row">
          <div class="col-12 mb-3">
            <div class="d-flex flex-column">
              <div class="row">
                <div class="col-12 col-sm-8">
                  <app-title [smallTitle]="true" [title]="'Items Details'"></app-title>
                </div>
                <div class="col-12 col-sm-4 ml-auto">
                  <div class="d-flex align-items-center">
                    <button type="button" class="close ml-auto"
                            (click)="hideItemContainer()">
                      X
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4 col-sm-6 col-12">
            <mat-form-field appearance="fill">
              <mat-label>Item Type</mat-label>
              <mat-select [(ngModel)]="itemType"
                          (selectionChange)="getTermType($event)"
                          required>
                <mat-option *ngFor="let option of formData.itemTypeList" [value]="option.id">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType">
            <mat-form-field appearance="fill">
              <mat-label>Import reason</mat-label>
              <mat-select (selectionChange)="getTheSelectedValueForImportedReason(itemType, $event)"
                          [disabled]="this.itemType === 'premix'"
                          [(ngModel)]="importReason" required>
                <mat-option *ngFor="let option of formData.importReasonList[itemType]" [value]="option.id">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'premix'">
            <mat-form-field appearance="fill">
              <mat-label>Premix name</mat-label>
              <mat-select [(ngModel)]="premixField" required>
                <mat-option *ngFor="let option of formData.premixNameList" [value]="option.id">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'rawMaterials'">
            <mat-form-field appearance="fill">
              <mat-label>Raw material name</mat-label>
              <mat-select [(ngModel)]="rowMaterialNameField" required>
                <mat-option *ngFor="let option of formData.rawMaterialList" [value]="option.id">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'packagingMaterial'">
            <mat-form-field appearance="fill">
              <mat-label>Packing item name</mat-label>
              <mat-select [(ngModel)]="packingItemNameField" required>
                <mat-option *ngFor="let option of formData.rawMaterialList" [value]="option.id">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-lg-4 col-sm-6 col-12" *ngIf="importReason && showNotificationNoStatus">
            <div class="row">
              <div class="col-6">
                <mat-form-field class="example-full-width">
                  <mat-label>Product Notification Number</mat-label>
                  <input type="text" class="form-control" matInput
                         [(ngModel)]="notificationNo"
                         placeholder="">
                </mat-form-field>
              </div>
              <div class="col-6 d-flex">
                <button type="button"
                        class="btn btn-primary ml-auto mt-sm-4 mb-3"
                        [disabled]="!notificationNo"
                        (click)="applyProduct(notificationNo)">
                  Get Product
                </button>
              </div>
            </div>
          </div>
          <div class="col-12 mt-3 d-none" [ngClass]="{'d-block': itemType && importReason}">
            <form class="mt-2" name="form" class="example-form" method="post"
                  [formGroup]="regItemsForm"
                  (keydown.enter)="$event.preventDefault()"
                  (ngSubmit)="onSubmitItems()" novalidate xmlns="http://www.w3.org/1999/html"
                  autocomplete="off">
              <tabset class="tabs" type="pills" #itemsStepsTabs>
                <tab heading="Item Details">
                  <div class="mt-5">
                    <div class="row mt-3">
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width">
                          <mat-label>Short Name</mat-label>
                          <input type="text" class="form-control" matInput formControlName="shortName"
                                 placeholder="Short Name">
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width">
                          <mat-label>Product Name (English)</mat-label>
                          <input type="text" class="form-control" matInput formControlName="ProductEnglishName"
                                 placeholder="Product Name (English)" required>
                          <div
                            *ngIf="regItemsForm.get('ProductEnglishName').invalid && (regItemsForm.get('ProductEnglishName').dirty || regItemsForm.get('ProductEnglishName').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('ProductEnglishName').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'premix'">
                        <mat-form-field class="example-full-width">
                          <mat-label>Source of raw material</mat-label>
                          <input type="text" class="form-control" matInput formControlName="sourceOfRawMaterial"
                                 placeholder="Source of raw material" required>
                          <div
                            *ngIf="regItemsForm.get('sourceOfRawMaterial').invalid && (regItemsForm.get('sourceOfRawMaterial').dirty || regItemsForm.get('sourceOfRawMaterial').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('sourceOfRawMaterial').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width">
                          <mat-label>Flag Type</mat-label>
                          <input type="text" class="form-control" matInput formControlName="flagType"
                                 disabled="true"
                                 placeholder="Flag Type">
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <mat-label>Manufacturing Company</mat-label>
                          <input type="text"
                                 class="form-control"
                                 placeholder="Manufacturing Company"
                                 aria-label="Manufacturing Company"
                                 matInput
                                 formControlName="manufacturingCompany"
                                 [matAutocomplete]="manufacturingCompanyList" required>
                          <mat-autocomplete #manufacturingCompanyList="matAutocomplete">
                            <mat-option *ngFor="let option of filteredOptionsForManufacturingCompany | async"
                                        [value]="option.NAME">
                              <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                    placement="top">{{option.NAME}}</span>
                            </mat-option>
                          </mat-autocomplete>
                          <div
                            *ngIf="regItemsForm.get('manufacturingCompany').invalid && (regItemsForm.get('manufacturingCompany').dirty || regItemsForm.get('manufacturingCompany').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('manufacturingCompany').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <mat-label>Manufacturing Country</mat-label>
                          <input type="text"
                                 class="form-control"
                                 placeholder="Manufacturing Country"
                                 aria-label="Manufacturing Country"
                                 matInput
                                 formControlName="manufacturingCountry"
                                 [matAutocomplete]="manufacturingCountryList" required>
                          <mat-autocomplete #manufacturingCountryList="matAutocomplete">
                            <mat-option *ngFor="let option of filteredOptionsForManufacturingCountry | async"
                                        [value]="option.NAME">
                              <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                    placement="top">{{option.NAME}}</span>
                            </mat-option>
                          </mat-autocomplete>
                          <div
                            *ngIf="regItemsForm.get('manufacturingCountry').invalid && (regItemsForm.get('manufacturingCountry').dirty || regItemsForm.get('manufacturingCountry').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('manufacturingCountry').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width">
                          <mat-label>Batch No.</mat-label>
                          <input type="text" class="form-control" matInput formControlName="batchNo"
                                 placeholder="Batch No." required>
                          <div
                            *ngIf="regItemsForm.get('batchNo').invalid && (regItemsForm.get('batchNo').dirty || regItemsForm.get('batchNo').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('batchNo').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width">
                          <mat-label>Quantity</mat-label>
                          <input type="text" class="form-control" matInput formControlName="quantity"
                                 placeholder="Quantity" required>
                          <div
                            *ngIf="regItemsForm.get('quantity').invalid && (regItemsForm.get('quantity').dirty || regItemsForm.get('quantity').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('quantity').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <mat-label>UOM (Unit of measure)</mat-label>
                          <input type="text"
                                 class="form-control"
                                 placeholder="UOM (Unit of measure)"
                                 aria-label="UOM (Unit of measure)"
                                 matInput
                                 formControlName="uom"
                                 [matAutocomplete]="UOMList" required>
                          <mat-autocomplete #UOMList="matAutocomplete">
                            <mat-option *ngFor="let option of filteredOptionsForUOM | async"
                                        [value]="option.NAME">
                              <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                    placement="top">{{option.NAME}}</span>
                            </mat-option>
                          </mat-autocomplete>
                          <div
                            *ngIf="regItemsForm.get('uom').invalid && (regItemsForm.get('uom').dirty || regItemsForm.get('uom').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('uom').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'premix' || itemType === 'rawMaterials'">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <mat-label>Ingrediant</mat-label>
                          <input type="text"
                                 class="form-control"
                                 placeholder="Ingrediant"
                                 aria-label="Ingrediant"
                                 matInput
                                 formControlName="ingredient"
                                 [matAutocomplete]="ingredientList" required>
                          <mat-autocomplete #ingredientList="matAutocomplete">
                            <mat-option *ngFor="let option of filteredOptionsForIngredientList | async"
                                        [value]="option.NAME">
                              <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                    placement="top">{{option.NAME}}</span>
                            </mat-option>
                          </mat-autocomplete>
                          <div
                            *ngIf="regItemsForm.get('ingredient').invalid && (regItemsForm.get('ingredient').dirty || regItemsForm.get('ingredient').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('ingredient').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'premix' || itemType === 'rawMaterials'">
                        <mat-form-field class="example-full-width">
                          <mat-label>Concentrations</mat-label>
                          <input type="text" class="form-control" matInput formControlName="concentration"
                                 placeholder="Concentrations" required>
                          <div
                            *ngIf="regItemsForm.get('concentration').invalid && (regItemsForm.get('concentration').dirty || regItemsForm.get('concentration').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('concentration').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                      <div class="col-lg-4 col-sm-6 col-12" *ngIf="itemType === 'premix' || itemType === 'rawMaterials'">
                        <mat-form-field class="example-full-width inputBesideSelect">
                          <mat-label>Function</mat-label>
                          <input type="text"
                                 class="form-control"
                                 placeholder="Function"
                                 aria-label="Function"
                                 matInput
                                 formControlName="function"
                                 [matAutocomplete]="functionList" required>
                          <mat-autocomplete #functionList="matAutocomplete">
                            <mat-option *ngFor="let option of filteredOptionsForFunctionList | async"
                                        [value]="option.NAME">
                              <span class="tooltipContainer" tooltip="{{option.NAME}}"
                                    placement="top">{{option.NAME}}</span>
                            </mat-option>
                          </mat-autocomplete>
                          <div
                            *ngIf="regItemsForm.get('function').invalid && (regItemsForm.get('function').dirty || regItemsForm.get('function').touched)"
                            class="alert alert-danger">
                            <div
                              *ngIf="regItemsForm.get('function').errors.required">
                              this field is required
                            </div>
                          </div>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </tab>
                <tab heading="Attachments" class="Item Attachments">
                  <div class="mt-5">
                    <div class="row mt-3">
                      <div class="col-lg-4 col-sm-6 col-12"
                           *ngFor="let field of ItemAttachmentFields"
                           [ngClass]="{'d-none': !field.enable}">
                        <div class="form-group">
                          <label>
                            {{field.name}}
                            <span class="requiredStar" *ngIf="field.required">*</span>
                          </label>
                          <div class="custom-file fileUpload mr-3"
                               [ngClass]="{'required': (regItemsForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'}">
                            <input type="file" class="custom-file-input" [id]="field.id"
                                   aria-describedby="fileHelp"
                                   (change)="onFileSelect($event, field.id)"
                                   [required]="field.required ? 'required' : false">
                            <div class="d-flex alert alert-danger"
                                 *ngIf="(regItemsForm.get(field.id).invalid && attachmentRequiredStatus) || field.attachmentTypeStatus === 'No'">
                              <div class="ml-auto mr-2" *ngIf="field.attachmentTypeStatus === 'No'">
                                this file must be as PDF and less than 5MB.
                              </div>
                              <div class="ml-auto"
                                   *ngIf="regItemsForm.get(field.id).invalid && attachmentRequiredStatus">
                                <div *ngIf="regItemsForm.get(field.id).errors.required">
                                  this field is required.
                                </div>
                              </div>
                            </div>
                            <label class="custom-file-label" [for]="field.id">
                              {{field.fileName ? field.fileName : 'Choose file'}}
                            </label>
                            <button type="button" class="custom-file-download-Button" *ngIf="field.fileValue"
                                    (click)="downloadFile(field.id)">Download
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </tab>
              </tabset>

              <div class="row buttonContainer btm-out">
                <div class="col-12 d-flex flex-column flex-md-row mt-3">
                  <button *ngIf="!itemsStepsTabs.tabs[0].active"
                          type="button"
                          class="btn btn-primary btn-sm mr-3 bottomButtons "
                          (click)="backToNextTab(itemsStepsTabs)">
                    Back item step
                  </button>
                  <div class="ml-md-auto">
                    <button *ngIf="!itemsStepsTabs.tabs[1].active"
                            type="button"
                            class="btn btn-primary btn-sm mr-3 bottomButtons"
                            (click)="nextToNextTab(itemsStepsTabs)">
                      Next item step
                    </button>

                    <button type="submit"
                            class="btn btn-primary btn-sm mr-3 bottomButtons">
                      Add Item
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="overlay" *ngIf="invoiceContainerDisplayStatus"></div>
      <div class="overlay2" *ngIf="itemContainerDisplayStatus"></div>
    </div>
  </div>
</div>

<alert type="success" (onClosed)="onClosed()" *ngIf="alertNotificationStatus">
  <strong>Thank You</strong> <br> {{alertNotification.msg}}
</alert>

<alert type="danger" class="AlertForAllRequests" dismissible="true" (onClosed)="onClosedErrorAlert()"
       *ngIf="alertErrorNotificationStatus">
  <strong>Error message</strong> <br> {{alertErrorNotification.msg}}
</alert>

<ng-template #successSubmissionModal>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Successful Submission</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closeSuccessSubmissionModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="modalContainer">
      <h2>
        <span>
          <i class="fas fa-check-circle"></i>
        </span>
      </h2>
      <h3>
        Thank you for submission
      </h3>
      <h3>
        Your request {{dataInAnyError.NotificationNo ? 'Notification Number' : 'id'}} is
        <b>{{ dataInAnyError.NotificationNo ? dataInAnyError.NotificationNo : dataInAnyError.id}}</b>
      </h3>
    </div>
  </div>
</ng-template>

<app-loader-component [loadingStatus]="isLoading"></app-loader-component>
